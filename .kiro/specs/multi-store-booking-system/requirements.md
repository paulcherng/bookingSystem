# 需求文件

## 簡介

多店家預約系統是一個可以讓多家店舖（以理髮店為例）管理預約的平台。系統整合 LINE 和電子郵件通訊，當客戶透過這些管道聯絡店家時，系統會自動檢查店家行事曆並回覆預約狀態。整個系統可部署到 Vercel 平台。

## 詞彙表

- **預約系統 (Booking_System)**: 管理多店家預約的核心平台
- **店家 (Store)**: 使用系統的商家，如理髮店
- **店家帳戶 (Store_Account)**: 店家在系統中的註冊帳戶
- **服務項目 (Service)**: 店家提供的服務，包含服務名稱和所需時間
- **營業時段 (Business_Hours)**: 店家的營業時間設定
- **理髮師 (Barber)**: 店家內的服務提供者，每位理髮師有獨立的行事曆
- **行事曆 (Calendar)**: 個別理髮師的預約時間表
- **通訊整合 (Communication_Integration)**: LINE 和電子郵件的整合功能
- **預約請求 (Booking_Request)**: 客戶透過 LINE 或電子郵件發送的預約需求
- **自動回覆 (Auto_Reply)**: 系統根據行事曆狀態自動發送的回覆訊息

## 需求

### 需求 1

**使用者故事:** 身為店家，我想要在系統中創建帳戶，以便我可以開始使用預約管理功能。

#### 驗收標準

1. WHEN 店家提供有效的店家資訊和聯絡方式 THEN 預約系統 SHALL 創建新的店家帳戶
2. WHEN 店家帳戶創建完成 THEN 預約系統 SHALL 發送確認訊息到店家指定的電子郵件
3. WHEN 店家嘗試使用已存在的電子郵件註冊 THEN 預約系統 SHALL 拒絕註冊並顯示錯誤訊息
4. WHEN 店家提供不完整的註冊資訊 THEN 預約系統 SHALL 要求補齊必要欄位

### 需求 2

**使用者故事:** 身為店家，我想要連結我的 LINE 帳號和電子郵件到系統，以便客戶可以透過這些管道聯絡我。

#### 驗收標準

1. WHEN 店家提供 LINE 帳號資訊 THEN 預約系統 SHALL 驗證並連結該 LINE 帳號到店家帳戶
2. WHEN 店家提供電子郵件地址 THEN 預約系統 SHALL 驗證並連結該電子郵件到店家帳戶
3. WHEN LINE 帳號連結成功 THEN 預約系統 SHALL 能夠接收來自該 LINE 帳號的訊息
4. WHEN 電子郵件連結成功 THEN 預約系統 SHALL 能夠接收來自該電子郵件的訊息
5. WHEN 連結的通訊管道無效 THEN 預約系統 SHALL 通知店家並要求重新設定

### 需求 3

**使用者故事:** 身為店家，我想要設定營業時段，以便系統只在營業時間內接受預約。

#### 驗收標準

1. WHEN 店家設定營業時段 THEN 預約系統 SHALL 儲存每日的開始和結束時間
2. WHEN 店家修改營業時段 THEN 預約系統 SHALL 更新時段設定並影響後續預約檢查
3. WHEN 客戶在非營業時間預約 THEN 預約系統 SHALL 拒絕預約並告知營業時間
4. WHEN 營業時段設定不完整 THEN 預約系統 SHALL 要求店家提供完整的時段資訊
5. WHEN 店家設定特殊營業日 THEN 預約系統 SHALL 支援假日或特殊日期的時段調整

### 需求 4

**使用者故事:** 身為店家，我想要在系統中新增理髮師並管理他們的行事曆，以便客戶可以預約特定理髮師或任何可用的理髮師。

#### 驗收標準

1. WHEN 店家新增理髮師 THEN 預約系統 SHALL 為該理髮師創建獨立的行事曆
2. WHEN 店家修改理髮師資訊 THEN 預約系統 SHALL 更新理髮師資料並保持行事曆關聯
3. WHEN 店家刪除理髮師 THEN 預約系統 SHALL 處理該理髮師的現有預約並移除行事曆
4. WHEN 理髮師資訊不完整 THEN 預約系統 SHALL 要求提供必要的理髮師資訊
5. WHEN 店家查看理髮師列表 THEN 預約系統 SHALL 顯示所有理髮師及其當前狀態

### 需求 5

**使用者故事:** 身為店家，我想要設定我提供的服務項目和所需時間，以便系統可以正確管理預約時程。

#### 驗收標準

1. WHEN 店家新增服務項目 THEN 預約系統 SHALL 儲存服務名稱和所需時間
2. WHEN 店家修改現有服務項目 THEN 預約系統 SHALL 更新服務資訊並保持資料一致性
3. WHEN 店家刪除服務項目 THEN 預約系統 SHALL 移除該服務並處理相關的現有預約
4. WHEN 店家設定服務所需時間 THEN 預約系統 SHALL 驗證時間格式為有效的分鐘數
5. WHEN 服務項目資訊不完整 THEN 預約系統 SHALL 拒絕儲存並顯示錯誤訊息

### 需求 6

**使用者故事:** 身為客戶，我想要透過 LINE 或電子郵件聯絡店家預約服務，以便我可以使用我習慣的通訊方式。

#### 驗收標準

1. WHEN 客戶透過 LINE 發送預約訊息 THEN 預約系統 SHALL 解析訊息內容並識別預約需求
2. WHEN 客戶透過電子郵件發送預約訊息 THEN 預約系統 SHALL 解析郵件內容並識別預約需求
3. WHEN 預約訊息包含服務項目和時間 THEN 預約系統 SHALL 提取這些資訊進行處理
4. WHEN 預約訊息格式不正確 THEN 預約系統 SHALL 回覆格式說明給客戶
5. WHEN 系統無法識別預約內容 THEN 預約系統 SHALL 要求客戶提供更清楚的資訊

### 需求 7

**使用者故事:** 身為系統，我需要檢查理髮師行事曆的可用性，以便正確回應客戶的預約請求。

#### 驗收標準

1. WHEN 客戶指定特定理髮師預約 THEN 預約系統 SHALL 查詢該理髮師的行事曆
2. WHEN 客戶未指定理髮師 THEN 預約系統 SHALL 查詢所有理髮師的行事曆並找出可用時段
3. WHEN 請求的時段已有預約 THEN 預約系統 SHALL 識別時段衝突
4. WHEN 請求的時段可用 THEN 預約系統 SHALL 標記該時段為可預約
5. WHEN 檢查服務所需時間 THEN 預約系統 SHALL 確認整個服務時段都可用且在營業時間內

### 需求 8

**使用者故事:** 身為系統，我需要自動回覆客戶的預約請求，以便提供即時的預約狀態回饋。

#### 驗收標準

1. WHEN 找到可用的理髮師時段 THEN 預約系統 SHALL 自動回覆確認預約並指定理髮師
2. WHEN 所有理髮師都無可用時段 THEN 預約系統 SHALL 自動回覆該時段無法提供服務
3. WHEN 透過 LINE 收到請求 THEN 預約系統 SHALL 透過 LINE 發送回覆訊息
4. WHEN 透過電子郵件收到請求 THEN 預約系統 SHALL 透過電子郵件發送回覆訊息
5. WHEN 自動回覆發送失敗 THEN 預約系統 SHALL 記錄錯誤並嘗試重新發送

### 需求 9

### 需求 9

**使用者故事:** 身為系統管理員，我想要將系統部署到 Vercel 並推送到指定的 Git repository，以便系統可以穩定運行並對外提供服務。

#### 驗收標準

1. WHEN 系統推送到 https://github.com/paulcherng/bookingSystem.git THEN 預約系統 SHALL 包含完整的原始碼和部署設定
2. WHEN 系統部署到 Vercel THEN 預約系統 SHALL 正常啟動並回應 HTTP 請求
3. WHEN 系統在 Vercel 運行 THEN 預約系統 SHALL 能夠處理 LINE webhook 請求
4. WHEN 系統在 Vercel 運行 THEN 預約系統 SHALL 能夠處理電子郵件 webhook 請求
5. WHEN 系統部署完成 THEN 預約系統 SHALL 提供健康檢查端點並記錄部署狀態

### 需求 10

**使用者故事:** 身為系統管理員，我想要有完整的部署文件和使用說明，以便能夠順利部署系統並指導使用者操作。

#### 驗收標準

1. WHEN 系統完成開發 THEN 預約系統 SHALL 提供詳細的 Vercel 部署步驟文件
2. WHEN 部署文件建立 THEN 預約系統 SHALL 包含環境變數設定說明
3. WHEN 系統部署 THEN 預約系統 SHALL 提供 LINE Bot 和電子郵件整合的設定指南
4. WHEN 使用文件建立 THEN 預約系統 SHALL 包含店家註冊和系統操作的完整說明
5. WHEN 文件完成 THEN 預約系統 SHALL 提供故障排除和常見問題解答